const episodesApi = {};

episodesApi.getEpisodes = (numberOfEpisodes, fromEpisode, isSubscribed) => new Promise((resolve, reject) => {

  const xmlhttp = new XMLHttpRequest();

  xmlhttp.open('POST', '/api/get/episodes', true);
  xmlhttp.setRequestHeader('Content-Type', 'application/json');

  xmlhttp.onreadystatechange = function() {
    if (xmlhttp.readyState === 4) {
      if (xmlhttp.status === 200) {
        const response = JSON.parse(xmlhttp.responseText);
        return response.status === 'OK' ? resolve(response.message) : reject(`Something went wrong: ${response.message}`);
      } else {
        return reject(JSON.parse(xmlhttp.responseText));
      }
    };
  };

  xmlhttp.send(JSON.stringify({numberOfEpisodes, fromEpisode, isSubscribed}));
  console.log(JSON.stringify({numberOfEpisodes, fromEpisode, isSubscribed}));
});

export default episodesApi;
