const host = 'http://localhost:3000/api/';

export default function Request(path, data = null) {
  return new Promise((resolve, reject) => {
    const xmlhttp = new XMLHttpRequest();
    const method = data === null ? 'GET' : 'POST';

    xmlhttp.open(method, host + path);
    xmlhttp.setRequestHeader('Content-Type', 'application/json');

    xmlhttp.onreadystatechange = function() {
      if (xmlhttp.readyState === 4) {
        if (xmlhttp.status === 200) {
          const response = JSON.parse(xmlhttp.responseText);
          return response.status === 'OK' ? resolve(response.message) : reject(response.message);
        } else {
          return reject('I don\'t know what it was.');
        }
      }
    };

    xmlhttp.send(JSON.stringify(data));
  });
};
