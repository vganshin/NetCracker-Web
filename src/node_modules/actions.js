import api from 'api'

/*
 * action types
 */

export const REQUEST_PROFILE = 'REQUEST_PROFILE'
export const RECEIVE_PROFILE = 'RECEIVE_PROFILE'
export const RECEIVE_ANONYMOUS = 'RECEIVE_ANONYMOUS'

/*
 * action creators
 */

export function receiveProfile(profile) {
  return {
    type: RECEIVE_PROFILE,
    profile: profile
  }
}

export function requestProfile() {
  return {
    type: REQUEST_PROFILE
  }
}

export function receiveAnonymous() {
  return {
    type: RECEIVE_ANONYMOUS
  }
}

export function login(credentials) {
  return dispatch => {
    dispatch(requestProfile());

    return api.login(credentials)
      .then(profile => dispatch(receiveProfile(profile)))
      .catch(error => dispatch(receiveAnonymous()))
  }
}